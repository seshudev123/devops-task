version: '3.8'
services:
mongo:
image: mongo:6.0
restart: unless-stopped
environment:
MONGO_INITDB_DATABASE: meanapp
volumes:
- mongo_data:/data/db


backend:
build:
context: .
dockerfile: Dockerfile.backend
image: ${DOCKERHUB_USERNAME:-yourdockerhub}/mean-backend:latest
restart: unless-stopped
environment:
- PORT=8080
- MONGODB_URI=mongodb://mongo:27017/meanapp
depends_on:
- mongo
expose:
- "8080"


frontend:
build:
context: .
dockerfile: Dockerfile.frontend
image: ${DOCKERHUB_USERNAME:-yourdockerhub}/mean-frontend:latest
restart: unless-stopped
expose:
- "80"


nginx-proxy:
image: nginx:stable-alpine
volumes:
- ./nginx-proxy/default.conf:/etc/nginx/conf.d/default.conf:ro
ports:
- "80:80"
depends_on:
- frontend
- backend
restart: unless-stopped


volumes:
mongo_data: